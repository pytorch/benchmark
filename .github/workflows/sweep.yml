name: TorchBench sweep v0.1
on:
  workflow_dispatch:
    inputs:
      repeat:
        description: "Repeat times for each sweep version"
        required: true
        default: 1

jobs:
  run-benchmark:
    if: ${{ github.repository_owner == 'pytorch' }}
    runs-on: [self-hosted, bm-metal]
    timeout-minutes: 2880 # 48 hours
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          ref: 0.1
      - name: Run benchmark
        run: |
          export NUM_ITER=${{ github.event.inputs.repeat }}
          bash ./.github/scripts/run-sweep-nodocker.sh
